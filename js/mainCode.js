const form=document.querySelector(".input-cover"),numBoxes=form.querySelectorAll(".input-box"),input=document.querySelector(".el-input.code").firstElementChild.firstElementChild,parent=document.querySelector(".login-left"),verify=document.querySelector(".verify-input-code"),goback=document.querySelector(".goback.fa"),buttons=document.querySelectorAll("#go"),errorTip=form.nextElementSibling;console.log(errorTip);const userEmail="",NUM_REGEXP=/[0-9]/;function isNumberValid(e){return NUM_REGEXP.test(e)}function sleep(e){return new Promise(t=>setTimeout(t,e))}const KEYBOARDS={backspace:8,arrowLeft:37,arrowRight:39};verify.addEventListener("click",e=>{document.querySelector(".ver-input").style.display=null,document.querySelector(".ver-code").style.display="none"}),goback.addEventListener("click",e=>{document.querySelector(".ver-input").style.display="none",document.querySelector(".ver-code").style.display=null}),document.addEventListener("click",e=>{e.target!==input?(input.blur(),input.parentElement.classList.remove("is-focus")):input.parentElement.classList.add("is-focus")}),input.addEventListener("input",e=>{isNumberValid(e.key)?(input.blur(),console.log(document.activeElement),input.parentElement.classList.remove("is-focus")):input.value=""});let codeList=[];function getCookie(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function gauth_code(e){var t=getCookie("unique_id"),o=JSON.stringify({unique_id:t,code:e});console.log(o),$.ajax({url:"https://api.imetastore.com/send_gauth_code/",type:"POST",data:o,timeout:5e4,dataType:"json",contentType:"application/json",accept:"application/json",success:function(e){if(console.log(e.status),console.log(buttons[2]),"success"===e.status){document.cookie=`username=${e.nickname}`,console.log(document.cookie);const t=new URLSearchParams(window.location.search);"/kyc-authentication"==t.get("redirect")?window.location.href=t.get("redirect"):window.location.href=" https://seller.imetastore.io/login"}else"failed"===e.status?(window.location.href="https://seller.imetastore.io/product/my",buttons[1].firstElementChild.style.display="none"):"timeout"===e.status?window.location.href="https://seller.imetastore.io/login":"gauth_error"===e.status&&(buttons[2].classList.remove("disabled"),buttons[2].removeAttribute("disabled"),buttons[2].style.backgroundColor=null,buttons[2].style.border=null,buttons[2].focus(),errorActive("google secondary verification failed"))}})}function errorActive(e){console.log(e),document.body.insertAdjacentHTML("beforeend",`\n      <div id="message_1" class="el-message el-message--error el-message-fade-enter-from" role="alert" style="top: 16px; z-index: 2002;">\x3c!--v-if--\x3e<i class="el-icon el-message__icon el-message-icon--error"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336L512 457.664z"></path></svg></i><p class="el-message__content">${e}</p>\x3c!--v-if--\x3e</div>\n      `),sleep(1).then(()=>{document.querySelector("#message_1").classList.remove("el-message-fade-enter-from")}),sleep(3e3).then(()=>{document.querySelector("#message_1").classList.add("el-message-fade-enter-from")}),sleep(3500).then(()=>{document.querySelector("#message_1").remove()})}document.addEventListener("keypress",e=>{if(input.blur(),"none"!==document.querySelector(".ver-code").style.display)return 0!=codeList.length&&input.parentElement.classList.contains("is-focus")&&isNumberValid(e.key)?(codeList[0]=e.key,input.value=e.key,input.parentElement.classList.remove("is-focus"),void console.log(codeList)):void(codeList.length<=5&&isNumberValid(e.key)&&(codeList.push(e.key),1==codeList.length?(input.parentElement.classList.remove("is-focus"),input.value=codeList[0],console.log(codeList)):(numBoxes[codeList.length-2].textContent=codeList[codeList.length-1],console.log(codeList))))}),document.addEventListener("keydown",e=>{"Backspace"==e.key&&(codeList.length>=2?(numBoxes[codeList.length-2].textContent=null,codeList.pop(),console.log(codeList)):(input.value=null,codeList.pop(),input.parentElement.classList.add("is-focus"),input.focus(),console.log(codeList)))}),buttons.forEach(e=>{e.addEventListener("click",t=>{if(e.firstElementChild.style.display=null,"email_code"==e.getAttribute("type")){let e="";e=codeList.join(""),email_code(e)}else if("gauth_code"==e.getAttribute("type")){t.preventDefault();let o=!0;for(let e=0;e<numBoxes.length;e++)""==numBoxes[e].textContent&&(o=!1);if(0==o)return void(errorTip.textContent="The verification code cannot be empty");errorTip.textContent="";let n="";n=codeList.join(""),e.classList.contains("disabled")||0==o||(console.log(e),e.style.backgroundColor="#6d87f1",e.style.border="#6d87f1",e.classList.add("disabled"),e.disabled=!0,gauth_code(n))}else if("gauth_sendCode"==e.getAttribute("type")){if(0==document.querySelector("#el-id-5116-2").value.length)return animationActive(document.querySelector("#el-id-5116-2")),void(document.querySelector("#el-id-5116-2").parentElement.parentElement.parentElement.lastElementChild.style.display=null);e.insertAdjacentHTML("afterbegin",'\n      <i class="el-icon is-loading">\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">\n        <path fill="currentColor" d="M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z">\n        </path>\n      </svg>\n    </i>\n      '),e.classList.add("disabled"),e.disabled=!0}})});